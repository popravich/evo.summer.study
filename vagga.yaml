_defaults:
  sampleXX: &sample
    container: ipython
    work-dir: examples


commands:
  doc: !Command
    container: sphinx
    work-dir: docs
    run:
    - make
    - html

  jupyter: !Command
    container: ipython
    work-dir: notebooks
    run:
    - jupyter
    - notebook
    - --no-browser
    - --ip
    - 0.0.0.0
    - --port
    - 8080

  sample01: !Command
    <<: *sample
    run: [python3, -m, sample01]
  sample02: !Command
    <<: *sample
    run: [python3, -m, sample02]

containers:
  sphinx:
    setup:
    - !Ubuntu xenial
    - !Install
      - make
    - !PipConfig { dependencies: true }
    - !Py3Install
      - sphinx
  ipython:
    auto-clean: true
    setup:
    - !Ubuntu xenial
    - !UbuntuUniverse
    - !Install [sqlite]
    - !PipConfig { dependencies: true }
    - !Py3Install
      - ipython
      - jupyter
    - !Py3Requirements examples/sample01/requirements.txt
    - !Py3Requirements examples/sample02/requirements.txt
    volumes:
      /root: !Persistent { name: jupyter }
    environ:
      PYTHONPATH: /work/examples:/work/notebooks
